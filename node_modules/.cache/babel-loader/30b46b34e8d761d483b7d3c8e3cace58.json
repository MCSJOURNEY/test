{"remainingRequest":"/Users/mcsjourneys/Desktop/startup-frontend-main/node_modules/babel-loader/lib/index.js!/Users/mcsjourneys/Desktop/startup-frontend-main/node_modules/eslint-loader/index.js??ref--13-0!/Users/mcsjourneys/Desktop/startup-frontend-main/src/permission.js","dependencies":[{"path":"/Users/mcsjourneys/Desktop/startup-frontend-main/src/permission.js","mtime":1655109659000},{"path":"/Users/mcsjourneys/Desktop/startup-frontend-main/babel.config.js","mtime":1655109659000},{"path":"/Users/mcsjourneys/Desktop/startup-frontend-main/node_modules/cache-loader/dist/cjs.js","mtime":1715598879413},{"path":"/Users/mcsjourneys/Desktop/startup-frontend-main/node_modules/babel-loader/lib/index.js","mtime":1715598884187},{"path":"/Users/mcsjourneys/Desktop/startup-frontend-main/node_modules/eslint-loader/index.js","mtime":1715598884748}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9yZWdlbmVyYXRvclJ1bnRpbWUgZnJvbSAiL1VzZXJzL21jc2pvdXJuZXlzL0Rlc2t0b3Avc3RhcnR1cC1mcm9udGVuZC1tYWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9yZWdlbmVyYXRvclJ1bnRpbWUuanMiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvVXNlcnMvbWNzam91cm5leXMvRGVza3RvcC9zdGFydHVwLWZyb250ZW5kLW1haW4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL21jc2pvdXJuZXlzL0Rlc2t0b3Avc3RhcnR1cC1mcm9udGVuZC1tYWluL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0IHJvdXRlciBmcm9tICcuL3JvdXRlcic7CmltcG9ydCBzdG9yZSBmcm9tICcuL3N0b3JlJzsKaW1wb3J0IHsgTWVzc2FnZSB9IGZyb20gJ2VsZW1lbnQtdWknOwppbXBvcnQgTlByb2dyZXNzIGZyb20gJ25wcm9ncmVzcyc7IC8vIHByb2dyZXNzIGJhcgppbXBvcnQgJ25wcm9ncmVzcy9ucHJvZ3Jlc3MuY3NzJzsgLy8gcHJvZ3Jlc3MgYmFyIHN0eWxlCmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAnQC91dGlscy9hdXRoJzsgLy8gZ2V0IHRva2VuIGZyb20gY29va2llCmltcG9ydCBnZXRQYWdlVGl0bGUgZnJvbSAnQC91dGlscy9nZXQtcGFnZS10aXRsZSc7Ck5Qcm9ncmVzcy5jb25maWd1cmUoewogIHNob3dTcGlubmVyOiBmYWxzZQp9KTsgLy8gTlByb2dyZXNzIENvbmZpZ3VyYXRpb24KCnZhciB3aGl0ZUxpc3QgPSBbJy9sb2dpbicsICcvcmVnaXN0ZXInLCAnL2JicyddOyAvLyBubyByZWRpcmVjdCB3aGl0ZWxpc3QKCnJvdXRlci5iZWZvcmVFYWNoKCAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9fcmVnZW5lcmF0b3JSdW50aW1lKCkubWFyayhmdW5jdGlvbiBfY2FsbGVlKHRvLCBmcm9tLCBuZXh0KSB7CiAgICB2YXIgaGFzVG9rZW47CiAgICByZXR1cm4gX3JlZ2VuZXJhdG9yUnVudGltZSgpLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgd2hpbGUgKDEpIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICAvLyBzdGFydCBwcm9ncmVzcyBiYXIKICAgICAgICAgIE5Qcm9ncmVzcy5zdGFydCgpOwoKICAgICAgICAgIC8vIHNldCBwYWdlIHRpdGxlCiAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IGdldFBhZ2VUaXRsZSh0by5tZXRhLnRpdGxlKTsKCiAgICAgICAgICAvLyBkZXRlcm1pbmUgd2hldGhlciB0aGUgdXNlciBoYXMgbG9nZ2VkIGluCiAgICAgICAgICBoYXNUb2tlbiA9IGdldFRva2VuKCk7CiAgICAgICAgICBpZiAoaGFzVG9rZW4pIHsKICAgICAgICAgICAgaWYgKHRvLnBhdGggPT09ICcvbG9naW4nICYmIHN0b3JlLmdldHRlcnMudXNlci51c2VyTmFtZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgICAgLy8gaWYgaXMgbG9nZ2VkIGluLCByZWRpcmVjdCB0byB0aGUgaG9tZSBwYWdlCiAgICAgICAgICAgICAgbmV4dCh7CiAgICAgICAgICAgICAgICBwYXRoOiAnLycKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBOUHJvZ3Jlc3MuZG9uZSgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGlmIChzdG9yZS5nZXR0ZXJzLnVzZXIudXNlck5hbWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgLy8g6aaW5qyh55m75b2V6ZyA6KaB6I635Y+W55So5oi35L+h5oGvCiAgICAgICAgICAgICAgICAgIHN0b3JlLmRpc3BhdGNoKCdnZXRJbmZvJykudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgLy8g5qC55o2u55So5oi35L+h5oGv6I635Y+W55So5oi35p2D6ZmQ5bm25Yqo5oCB5Yqg6L29CiAgICAgICAgICAgICAgICAgICAgc3RvcmUuZGlzcGF0Y2goJ3Blcm1pc3Npb24vZ2VuZXJhdGVSb3V0ZXMnKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0KF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdG8pLCB7fSwgewogICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlOiB0cnVlCiAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgc3RvcmUuZGlzcGF0Y2goJ3VzZXIvcmVzZXRUb2tlbicpOwogICAgICAgICAgICAgICAgICBNZXNzYWdlLmVycm9yKGVycm9yIHx8ICdIYXMgRXJyb3InKTsKICAgICAgICAgICAgICAgICAgbmV4dCgiL2xvZ2luP3JlZGlyZWN0PSIuY29uY2F0KHRvLnBhdGgpKTsKICAgICAgICAgICAgICAgICAgTlByb2dyZXNzLmRvbmUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8g5aaC5p6c5pyq6KOF6L296L+H77yM5YiZ6ZyA6KaB6KOF6L29CiAgICAgICAgICAgICAgICBpZiAoIXN0b3JlLmdldHRlcnMubWVudUxvYWRlZCkgewogICAgICAgICAgICAgICAgICBzdG9yZS5kaXNwYXRjaCgncGVybWlzc2lvbi9nZW5lcmF0ZVJvdXRlcycpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXh0KCk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLyogaGFzIG5vIHRva2VuKi8KICAgICAgICAgICAgaWYgKHdoaXRlTGlzdC5pbmRleE9mKHRvLnBhdGgpICE9PSAtMSkgewogICAgICAgICAgICAgIC8vIGluIHRoZSBmcmVlIGxvZ2luIHdoaXRlbGlzdCwgZ28gZGlyZWN0bHkKICAgICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gb3RoZXIgcGFnZXMgdGhhdCBkbyBub3QgaGF2ZSBwZXJtaXNzaW9uIHRvIGFjY2VzcyBhcmUgcmVkaXJlY3RlZCB0byB0aGUgbG9naW4gcGFnZS4KICAgICAgICAgICAgICBuZXh0KCIvbG9naW4/cmVkaXJlY3Q9Ii5jb25jYXQodG8ucGF0aCkpOwogICAgICAgICAgICAgIE5Qcm9ncmVzcy5kb25lKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICBjYXNlIDQ6CiAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKICByZXR1cm4gZnVuY3Rpb24gKF94LCBfeDIsIF94MykgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCkpOwpyb3V0ZXIuYWZ0ZXJFYWNoKGZ1bmN0aW9uICgpIHsKICAvLyBmaW5pc2ggcHJvZ3Jlc3MgYmFyCiAgTlByb2dyZXNzLmRvbmUoKTsKfSk7"},{"version":3,"names":["router","store","Message","NProgress","getToken","getPageTitle","configure","showSpinner","whiteList","beforeEach","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","to","from","next","hasToken","wrap","_callee$","_context","prev","start","document","title","meta","path","getters","user","userName","undefined","done","dispatch","then","_objectSpread","replace","error","concat","menuLoaded","indexOf","stop","_x","_x2","_x3","apply","arguments","afterEach"],"sources":["/Users/mcsjourneys/Desktop/startup-frontend-main/src/permission.js"],"sourcesContent":["import router from './router'\nimport store from './store'\nimport { Message } from 'element-ui'\nimport NProgress from 'nprogress' // progress bar\nimport 'nprogress/nprogress.css' // progress bar style\nimport { getToken } from '@/utils/auth' // get token from cookie\nimport getPageTitle from '@/utils/get-page-title'\n\nNProgress.configure({ showSpinner: false }) // NProgress Configuration\n\nconst whiteList = ['/login', '/register', '/bbs'] // no redirect whitelist\n\nrouter.beforeEach(async(to, from, next) => {\n  // start progress bar\n  NProgress.start()\n\n  // set page title\n  document.title = getPageTitle(to.meta.title)\n\n  // determine whether the user has logged in\n  const hasToken = getToken()\n\n  if (hasToken) {\n    if (to.path === '/login' && store.getters.user.userName !== undefined) {\n      // if is logged in, redirect to the home page\n      next({ path: '/' })\n      NProgress.done()\n    } else {\n      if (store.getters.user.userName === undefined) {\n        try {\n          // 首次登录需要获取用户信息\n          store.dispatch('getInfo').then(() => {\n            // 根据用户信息获取用户权限并动态加载\n            store.dispatch('permission/generateRoutes').then(() => next({ ...to, replace: true }))\n          })\n        } catch (error) {\n          store.dispatch('user/resetToken')\n          Message.error(error || 'Has Error')\n          next(`/login?redirect=${to.path}`)\n          NProgress.done()\n        }\n      } else {\n        // 如果未装载过，则需要装载\n        if (!store.getters.menuLoaded) {\n          store.dispatch('permission/generateRoutes').then(() => next())\n        } else {\n          next()\n        }\n      }\n    }\n  } else {\n    /* has no token*/\n    if (whiteList.indexOf(to.path) !== -1) {\n      // in the free login whitelist, go directly\n      next()\n    } else {\n      // other pages that do not have permission to access are redirected to the login page.\n      next(`/login?redirect=${to.path}`)\n      NProgress.done()\n    }\n  }\n})\n\nrouter.afterEach(() => {\n  // finish progress bar\n  NProgress.done()\n})\n"],"mappings":"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","ignoreList":[]}]}
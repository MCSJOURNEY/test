{"remainingRequest":"/Users/mcsjourneys/Desktop/startup-frontend-main/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mcsjourneys/Desktop/startup-frontend-main/src/views/user/index.vue?vue&type=style&index=1&id=4498f7b0&rel=stylesheet%2Fscss&lang=scss&scoped=true","dependencies":[{"path":"/Users/mcsjourneys/Desktop/startup-frontend-main/src/views/user/index.vue","mtime":1655109659000},{"path":"/Users/mcsjourneys/Desktop/startup-frontend-main/node_modules/css-loader/dist/cjs.js","mtime":1715598878831},{"path":"/Users/mcsjourneys/Desktop/startup-frontend-main/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1715598879821},{"path":"/Users/mcsjourneys/Desktop/startup-frontend-main/node_modules/postcss-loader/src/index.js","mtime":1715598882466},{"path":"/Users/mcsjourneys/Desktop/startup-frontend-main/node_modules/sass-loader/dist/cjs.js","mtime":1715598879029},{"path":"/Users/mcsjourneys/Desktop/startup-frontend-main/node_modules/cache-loader/dist/cjs.js","mtime":1715598879413},{"path":"/Users/mcsjourneys/Desktop/startup-frontend-main/node_modules/vue-loader/lib/index.js","mtime":1715598879453}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKOjp2LWRlZXAgLmVsLWlucHV0LW51bWJlciAuZWwtaW5wdXRfX2lubmVyIHsKICB0ZXh0LWFsaWduOiBsZWZ0Owp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkWA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <!--工具栏-->\n    <div class=\"head-container\">\n      <!-- 搜索 -->\n      <el-input\n        v-model=\"userName\"\n        size=\"small\"\n        clearable\n        placeholder=\"输入账号或用户名称搜索\"\n        style=\"width: 200px\"\n        class=\"filter-item\"\n        @keyup.enter.native=\"doQuery\"\n      />\n      <el-date-picker\n        v-model=\"createTime\"\n        :default-time=\"['00:00:00', '23:59:59']\"\n        type=\"daterange\"\n        range-separator=\":\"\n        size=\"small\"\n        class=\"date-item\"\n        value-format=\"yyyy-MM-dd HH:mm:ss\"\n        start-placeholder=\"开始日期\"\n        end-placeholder=\"结束日期\"\n      />\n      <el-button\n        class=\"filter-item\"\n        size=\"mini\"\n        type=\"success\"\n        icon=\"el-icon-search\"\n        @click=\"doQuery\"\n      >搜索</el-button>\n      <el-button\n        class=\"filter-item\"\n        size=\"mini\"\n        type=\"danger\"\n        icon=\"el-icon-circle-plus-outline\"\n        :disabled=\"selections.length === 0\"\n        @click=\"doDelete\"\n      >删除</el-button>\n    </div>\n\n    <el-row>\n      <!--角色分配表单-->\n      <el-dialog\n        append-to-body\n        :close-on-click-modal=\"false\"\n        :visible.sync=\"showDialog\"\n        title=\"角色分配\"\n        width=\"600px\"\n      >\n        <el-form\n          ref=\"form\"\n          :inline=\"true\"\n          :model=\"form\"\n          size=\"small\"\n          label-width=\"76px\"\n        >\n          <el-form-item label=\"登录账号\" prop=\"userName\">\n            <el-input v-model=\"form.userName\" :disabled=\"true\" />\n          </el-form-item>\n          <el-form-item label=\"昵称\" prop=\"nickName\">\n            <el-input v-model=\"form.nickName\" :disabled=\"true\" />\n          </el-form-item>\n          <el-form-item style=\"margin-bottom: 0\" label=\"角色\" prop=\"userRoles\">\n            <el-select\n              v-model=\"userRoles\"\n              style=\"width: 455px\"\n              multiple\n              filterable\n              placeholder=\"请选择\"\n              @remove-tag=\"deleteTag\"\n              @change=\"changeRole\"\n            >\n              <el-option\n                v-for=\"item in roles\"\n                :key=\"item.roleCode\"\n                :label=\"item.roleName\"\n                :value=\"item.id\"\n              />\n            </el-select>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button type=\"text\" @click=\"doCancel\">取消</el-button>\n          <el-button\n            :loading=\"formLoading\"\n            type=\"primary\"\n            @click=\"doSubmit\"\n          >确认</el-button>\n        </div>\n      </el-dialog>\n      <el-tabs v-model=\"activeName\" type=\"border-card\">\n        <el-tab-pane label=\"用户列表\" name=\"userList\">\n          <el-table\n            ref=\"table\"\n            v-loading=\"loading\"\n            :data=\"users\"\n            style=\"width: 100%; font-size: 12px\"\n            @selection-change=\"selectionChangeHandler\"\n          >\n            <el-table-column type=\"selection\" width=\"55\" />\n            <el-table-column\n              :show-overflow-tooltip=\"true\"\n              width=\"150\"\n              prop=\"userName\"\n              label=\"登录账号\"\n            />\n            <el-table-column\n              :show-overflow-tooltip=\"true\"\n              width=\"150\"\n              prop=\"nickName\"\n              label=\"用户昵称\"\n            />\n            <el-table-column prop=\"gender\" width=\"60\" label=\"性别\">\n              <template slot-scope=\"scope\">\n                <el-tag v-if=\"scope.row.gender === 1\" type=\"success\">男</el-tag>\n                <el-tag v-if=\"scope.row.gender === 2\" type=\"warning\">女</el-tag>\n                <el-tag v-if=\"scope.row.gender === 0\" type=\"info\">未知</el-tag>\n              </template>\n            </el-table-column>\n            <el-table-column\n              :show-overflow-tooltip=\"true\"\n              prop=\"phone\"\n              width=\"150\"\n              label=\"电话\"\n            />\n            <el-table-column\n              :show-overflow-tooltip=\"true\"\n              prop=\"city\"\n              label=\"所在地区\"\n            >\n              <template slot-scope=\"scope\">\n                <span>{{ scope.row.province }} {{ scope.row.city }}\n                  {{ scope.row.country }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column\n              :show-overflow-tooltip=\"true\"\n              prop=\"avatarUrl\"\n              width=\"80\"\n              label=\"头像\"\n            >\n              <template slot-scope=\"scope\">\n                <img\n                  :src=\"\n                    scope.row.avatarUrl\n                      ? baseApi + '/file/' + scope.row.avatarUrl\n                      : Avatar\n                  \"\n                  class=\"avatar\"\n                >\n              </template>\n            </el-table-column>\n            <el-table-column\n              :show-overflow-tooltip=\"true\"\n              prop=\"createTime\"\n              width=\"155\"\n              label=\"注册日期\"\n            >\n              <template slot-scope=\"scope\">\n                <span>{{ parseTime(scope.row.createTime) }}</span>\n              </template>\n            </el-table-column>\n            <el-table-column\n              label=\"操作\"\n              width=\"160\"\n              align=\"center\"\n              fixed=\"right\"\n            >\n              <template slot-scope=\"scope\">\n                <el-button\n                  size=\"mini\"\n                  type=\"text\"\n                  round\n                  @click=\"doAssignRole(scope.row.id)\"\n                >分配角色</el-button>\n              </template>\n            </el-table-column>\n          </el-table>\n          <el-pagination\n            class=\"page\"\n            background\n            :current-page=\"currentPage\"\n            :page-sizes=\"[5, 10, 15, 20]\"\n            :page-size=\"pageSize\"\n            layout=\"sizes,prev, pager, next\"\n            :total=\"totalPage\"\n            @size-change=\"handleSizeChange\"\n            @current-change=\"handleCurrentChange\"\n          />\n        </el-tab-pane>\n      </el-tabs>\n    </el-row>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nimport Avatar from '@/assets/images/avatar.png'\nimport { parseTime } from '@/utils/index'\nimport { getUserPageList, deleteUser, getInfoById, getUserRoles, saveUserRoles } from '@/api/user'\nimport { getRoleList } from '@/api/role'\nexport default {\n  name: '用户管理',\n  data() {\n    return {\n      Avatar: Avatar,\n      activeName: 'userList',\n      showDialog: false,\n      loading: false,\n      formLoading: true,\n      form: {},\n      totalPage: 0,\n      currentPage: 1,\n      pageSize: 5,\n      users: [],\n      selections: [],\n      userName: '',\n      createTime: null,\n      roles: [],\n      userRoles: []\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'baseApi'\n    ])\n  },\n  created() {\n\n  },\n  methods: {\n    parseTime,\n    doQuery() {\n      this.users = []\n      var param = { userName: this.userName }\n      if (this.createTime != null) {\n        param.createTimeStart = Date.parse(this.createTime[0])\n        param.createTimeEnd = Date.parse(this.createTime[1])\n      }\n      param.pageSize = this.pageSize\n      param.currentPage = this.currentPage\n      console.log(param)\n      getUserPageList(param).then(res => {\n        if (res) {\n          this.totalPage = res.totalPage\n          this.currentPage = res.currentPage\n          this.users = res.sysUserList\n        }\n      })\n    },\n    handleSizeChange(val) {\n      this.pageSize = val\n      this.doQuery()\n    },\n    handleCurrentChange(val) {\n      this.currentPage = val\n      this.doQuery()\n    },\n    doDelete() {\n      const ids = []\n      this.selections.forEach((res) => {\n        ids.push(res.id)\n      })\n      this.$confirm(`确认删除这些用户吗?`, '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() =>\n        deleteUser(ids).then(res => {\n          if (res) {\n            this.$notify({\n              title: '删除成功',\n              type: 'success',\n              duration: 2500\n            })\n            this.doQuery()\n          }\n        })\n      ).catch(() => {\n      })\n    },\n    // 选择改变\n    selectionChangeHandler(val) {\n      this.selections = val\n    },\n    doAssignRole(id) {\n      this.form = {}\n      this.userRoles = []\n      this.roles = []\n      this.showDialog = true\n      this.formLoading = true\n      getInfoById(id).then((res) => {\n        this.form = { id: res.id, userName: res.userName, nickName: res.nickName, gender: res.gender, phone: res.phone }\n        var param = {}\n        getRoleList(param).then(res => {\n          if (res) {\n            this.roles = res\n          }\n          getUserRoles(id).then((res) => {\n            if (res) {\n              res.forEach(role => {\n                this.userRoles.push(role.id)\n              })\n            }\n            this.formLoading = false\n          })\n        })\n      })\n    },\n    doCancel() {\n      this.showDialog = false\n      this.form = {}\n    },\n    doSubmit() {\n      this.formLoading = true\n      saveUserRoles(this.form.id, this.userRoles).then(() => {\n        this.showDialog = false\n        this.$notify({\n          title: '保存成功',\n          type: 'success',\n          duration: 2500\n        })\n      })\n    },\n    deleteTag(value) {\n      this.userRoles.forEach(function(data, index) {\n        if (data.id === value) {\n          this.userRoles.splice(index, value)\n        }\n      })\n    },\n    changeRole(value) {\n      // console.log(this.userRoles)\n    }\n  }\n}\n\n</script>\n\n<style rel=\"stylesheet/scss\" lang=\"scss\">\n.avatar {\n  width: 32px;\n  height: 32px;\n  border-radius: 50%;\n}\n.page{\n  float: right;\n  margin-top: 5px;\n}\n</style>\n\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\n::v-deep .el-input-number .el-input__inner {\n  text-align: left;\n}\n</style>\n"]}]}